(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{186:function(_,v,t){"use strict";t.r(v);var e=t(0),a=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"从输入url到页面加载完毕中间发生了什么？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从输入url到页面加载完毕中间发生了什么？","aria-hidden":"true"}},[_._v("#")]),_._v(" 从输入url到页面加载完毕中间发生了什么？")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1512719712809&di=e3612f9c2013a7a2f2ba2085ece52883&imgtype=0&src=http%3A%2F%2Fnews.5068.com%2Fupfiles%2Fallimg%2F150414%2F8570_150414165859_4.jpg",alt:"矢量图"}})]),_._v(" "),t("blockquote",[t("p",[_._v("我们平时从浏览器中输入网址，到页面完整的呈现在面前，这中间究竟发生了什么呢？")])]),_._v(" "),t("h2",{attrs:{id:"step1-在浏览器地址栏敲入url"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step1-在浏览器地址栏敲入url","aria-hidden":"true"}},[_._v("#")]),_._v(" STEP1: 在浏览器地址栏敲入url")]),_._v(" "),t("h3",{attrs:{id:"首先，什么是url？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#首先，什么是url？","aria-hidden":"true"}},[_._v("#")]),_._v(" 首先，什么是"),t("strong",[_._v("url")]),_._v("？")]),_._v(" "),t("p",[_._v("url or "),t("em",[_._v("Uniform resource locator")]),_._v("，统一资源定位符，用于定位互联网上的资源，其实就是日常生活中我们所说的"),t("strong",[_._v("网址")]),_._v("。url的格式为")]),_._v(" "),t("blockquote",[t("p",[_._v("协议类型://主机名:端口/路径/资源文件名")])]),_._v(" "),t("p",[_._v("相应的例子如下：")]),_._v(" "),t("blockquote",[t("p",[_._v("http://www.jianshu.com/u/553d6196311c")])]),_._v(" "),t("p",[_._v("以上范例是我简书的个人主页url:")]),_._v(" "),t("ul",[t("li",[t("p",[t("code",[_._v("http")]),_._v("表示与web服务器的通讯方式采用的协议类型为"),t("strong",[_._v("超文本协议")]),_._v("，其它协议类型还有"),t("code",[_._v("https")]),_._v("（非明文的加密传输类型）、"),t("code",[_._v("file")]),_._v("、"),t("code",[_._v("ftp")]),_._v("、"),t("code",[_._v("mailto")]),_._v("等等；")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("jianshu.com")]),_._v("就是主机的域名;")])]),_._v(" "),t("li",[t("p",[_._v("主机域名后还会跟着冒号加数字的形式，为端口号，一台服务器可能拥有有大量的端口号，因此，指定一个端口编号以便告诉web服务器所在的主机要将请求交给哪个服务；默认情况下，http的端口号为"),t("code",[_._v("80")]),_._v("，因此可以省略端口号。")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("u/553d6196311c")]),_._v("表示所请求的文件存在主机上的路径。")])])]),_._v(" "),t("h3",{attrs:{id:"ip是什么？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ip是什么？","aria-hidden":"true"}},[_._v("#")]),_._v(" IP是什么？")]),_._v(" "),t("blockquote",[t("p",[_._v("IP(Internet Protocol)，计算机为了实现相互通信而遵守的协议，每个处于互联网中的设备都有IP。")])]),_._v(" "),t("p",[_._v("如，192.168.0.1表示本地局域网，而127.0.0.1代表本机IP。局域网IP与公网IP是有区别的，局域网中所有人都是用路由器，使用局域网IP。")]),_._v(" "),t("h3",{attrs:{id:"为什么要用域名？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用域名？","aria-hidden":"true"}},[_._v("#")]),_._v(" 为什么要用域名？")]),_._v(" "),t("p",[_._v("不用IP而使用域名来访问网站的原因是，域名是"),t("strong",[_._v("语义化")]),_._v("的，可以被赋予人类语言或者代称，方便人类记忆与辨识，而IP是给程序看的。")]),_._v(" "),t("p",[_._v("浏览器实际上是不知道"),t("code",[_._v("jianshu.com")]),_._v("是什么意思，它需要通过解析域名来获取这个站点所在服务器的IP，才能找到目标。所以我们来聊聊STEP2:"),t("strong",[_._v("域名解析")])]),_._v(" "),t("h2",{attrs:{id:"step2-域名解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step2-域名解析","aria-hidden":"true"}},[_._v("#")]),_._v(" STEP2: 域名解析")]),_._v(" "),t("blockquote",[t("p",[_._v("如何把一个域名解析为IP地址？\n当用户输入在浏览器地址栏中输入url后，你的电脑会发出一个DNS请求到本地DNS服务器。")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("DNS(Domain Name System)")]),_._v("：域名与IP地址ip地址相互映射的一个分布式数据库；")]),_._v(" "),t("li",[t("strong",[_._v("本地DNS服务器")]),_._v("：一般是网络接入的服务商提供的，比如中国电信、铁通等；")]),_._v(" "),t("li",[t("strong",[_._v("域名解析")]),_._v("：使用户得以通过主机名，获得该主机名对应的IP地址的过程；")])]),_._v(" "),t("blockquote",[t("p",[_._v("DNS请求到达本地后，开始域名解析：")])]),_._v(" "),t("ul",[t("li",[_._v("浏览器缓存")])]),_._v(" "),t("blockquote",[t("p",[_._v("首先，浏览器会先开始从浏览器缓存中查找此前是否有这个域名对应的IP，如果缓存中有，域名解析结束；")])]),_._v(" "),t("blockquote",[t("p",[_._v("chrome浏览器可以通过"),t("code",[_._v("chrome://net-internals/#dns")]),_._v("来查看浏览器的DNS缓存时间：")])]),_._v(" "),t("blockquote",[t("p",[t("img",{attrs:{src:"https://i.loli.net/2017/12/09/5a2abe0f86a24.png",alt:"屏幕快照 2017-12-09 上午12.27.37.png"}})])]),_._v(" "),t("ul",[t("li",[_._v("系统缓存")])]),_._v(" "),t("blockquote",[t("p",[_._v("如果浏览器中没有缓存，浏览器会从系统中的"),t("code",[_._v("host")]),_._v("文件中查找是否有该域名对应的IP；")])]),_._v(" "),t("blockquote",[t("p",[t("img",{attrs:{src:"https://i.loli.net/2017/12/09/5a2abf141ae6e.png",alt:"屏幕快照 2017-12-09 上午12.34.04.png"}})])]),_._v(" "),t("blockquote",[t("p",[_._v("macos中host路劲：finder下shift+command+g，输入路径：/etc/hosts")])]),_._v(" "),t("ul",[t("li",[_._v("路由器缓存")])]),_._v(" "),t("blockquote",[t("p",[_._v("如果"),t("code",[_._v("host")]),_._v("文件中也没有缓存，便会查看连接过的路由器是否有缓存信息；")])]),_._v(" "),t("ul",[t("li",[_._v("ISP(internet service provider) DNS缓存")])]),_._v(" "),t("blockquote",[t("p",[_._v("如果路由器缓存也找不到，那就查找ISP DNS缓存，比如到电信的DNS上查找缓存。我们经常在网络设置中输入的"),t("code",[_._v("114.114.114.114")]),_._v("就是本地区的域名服务器，在全国各地都有部署节点，访问相对较快。")])]),_._v(" "),t("ul",[t("li",[_._v("迭代查询")])]),_._v(" "),t("blockquote",[t("p",[_._v("如果以上办法都找不到，则会向根域名服务器查找域名对应的IP，根域名服务器把请求转发到下一级，不断地返回IP，直到找到最终完整的IP地址；")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("根域名")]),_._v("：可以理解为域名后缀，com、net、cn、org；")]),_._v(" "),t("li",[t("strong",[_._v("顶级域名")]),_._v("：baidu.com")])]),_._v(" "),t("blockquote",[t("p",[_._v("整体流程如下：\n"),t("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/5308475-cf58e66c93c1f2ec.gif",alt:"迭代查询"}})])]),_._v(" "),t("p",[_._v("当通过域名解析查找到IP地址之后，浏览器将用户发起的http请求发给服务器，例如："),t("code",[_._v("GET http://www.baidu.com/ HTTP/1.1")])]),_._v(" "),t("h2",{attrs:{id:"step3-服务器处理请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step3-服务器处理请求","aria-hidden":"true"}},[_._v("#")]),_._v(" STEP3: 服务器处理请求")]),_._v(" "),t("blockquote",[t("p",[_._v("服务器是一台安装了linux系统的机器，系统里安装了处理请求的应用/软件叫"),t("code",[_._v("web server")]),_._v("，常见的如："),t("code",[_._v("apache")]),_._v(" 、"),t("code",[_._v("nginx")]),_._v(" 、"),t("code",[_._v("IIS")]),_._v("等；")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("web服务器")]),_._v("：")])]),_._v(" "),t("p",[_._v("当"),t("code",[_._v("web server")]),_._v("接收到一个HTTP请求（request），会返回一个HTTP响应（response），例如送回一个HTML页面。所以web服务器就像一个管控或者承载，来调配用户的不同请求，将这些请求委托给服务器上处理对应请求的程序进行处理，如，服务端JS、JSP脚本，ASP脚本等等。")]),_._v(" "),t("p",[_._v("这些服务端的程序如何处理请求，实际上就是后台处理的工作了。后台开发现在有很多框架，但大部分都还是按照MVC设计模式进行搭建的。")]),_._v(" "),t("blockquote",[t("p",[t("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/5308475-d45e8967170041f2.png",alt:"MVC设计模式"}})])]),_._v(" "),t("h3",{attrs:{id:"mvc设计模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mvc设计模式","aria-hidden":"true"}},[_._v("#")]),_._v(" MVC设计模式")]),_._v(" "),t("p",[_._v("用户输入请求，首先被控制器（起统一管理作用）接收，控制器来决定用哪个模型（操作数据库，给控制器提供接口）来处理来进行处理，然后模型根据业务逻辑处理用户请求，并且从数据库中返回存取数据，返回给控制器后，控制器确定用哪一个视图模型（把数据填写到视图模板），组合后返回给浏览器，并最终呈现为页面。")]),_._v(" "),t("h2",{attrs:{id:"step4-浏览器处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step4-浏览器处理","aria-hidden":"true"}},[_._v("#")]),_._v(" STEP4: 浏览器处理")]),_._v(" "),t("blockquote",[t("p",[_._v("接下来就是浏览器处理，通过后台返回的HTML被一句句读取、解析，html页面在此过程中，经历了加载，解析，渲染。")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("加载")])])]),_._v(" "),t("ol",[t("li",[_._v("浏览器对一份HTML文件的加载顺序是自上而下，逐行加载的")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("解析")])])]),_._v(" "),t("ol",[t("li",[_._v("解析到"),t("code",[_._v("<link>")]),_._v("，重新发送请求，获取css代码；")]),_._v(" "),t("li",[_._v("解析到"),t("code",[_._v("<script>")]),_._v("，发送请求，加载js，并且停止渲染，加载及解析完毕后，继续渲染其它；")]),_._v(" "),t("li",[_._v("解析到"),t("code",[_._v("<img>")]),_._v("，发送请求获取图片资源；")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("渲染")])])]),_._v(" "),t("ol",[t("li",[_._v("浏览器根据HTML和CSS计算得到渲染树，绘制到用户屏幕上。")])])])}],!1,null,null,null);a.options.__file="从输入URL到页面展现究竟发生了什么.md";v.default=a.exports}}]);