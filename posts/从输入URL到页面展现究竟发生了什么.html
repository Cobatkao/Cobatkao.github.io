<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从输入url到页面加载完毕中间发生了什么？ | 猪脚面线的知识库</title>
    <meta name="description" content="For what it&#39;s worth, it&#39;s never too late.（Updating... XD）">
    <link rel="icon" href="/isaacgaoblog/logo.ico">
    
    <link rel="preload" href="/isaacgaoblog/assets/css/0.styles.60655061.css" as="style"><link rel="preload" href="/isaacgaoblog/assets/js/app.01da7489.js" as="script"><link rel="preload" href="/isaacgaoblog/assets/js/21.341d678b.js" as="script"><link rel="prefetch" href="/isaacgaoblog/assets/js/10.bb6e04e4.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/11.391fd545.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/12.602facc5.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/13.2d9982a6.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/14.83aaa352.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/15.90b7ef7b.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/16.fb97507d.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/17.d2fb61a5.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/18.5f85ae3a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/19.b706601e.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/2.3704caf5.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/20.66d4ff5f.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/22.3af63f24.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/23.4ecf9c22.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/24.15a6c94a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/25.bc5a5667.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/26.823bab78.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/27.0327437d.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/28.db82409c.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/29.e695a449.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/3.98b19d1d.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/4.4d6e9538.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/5.44d0334a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/6.b35e585c.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/7.723d1e3a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/8.e2bfc8ff.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/9.508f61f1.js">
    <link rel="stylesheet" href="/isaacgaoblog/assets/css/0.styles.60655061.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/isaacgaoblog/" class="home-link router-link-active"><!----> <span class="site-name">猪脚面线的知识库</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/isaacgaoblog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/frontend/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/backend/" class="nav-link">后端</a></li></ul></div></div><div class="nav-item"><a href="/isaacgaoblog/posts/" class="nav-link router-link-active">博文</a></div><div class="nav-item"><a href="https://www.github.com/Cobatkao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/isaacgaoblog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/frontend/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/backend/" class="nav-link">后端</a></li></ul></div></div><div class="nav-item"><a href="/isaacgaoblog/posts/" class="nav-link router-link-active">博文</a></div><div class="nav-item"><a href="https://www.github.com/Cobatkao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>博文</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/isaacgaoblog/posts/" class="sidebar-link">碎碎念</a></li><li><a href="/isaacgaoblog/posts/布局全解.html" class="sidebar-link">布局全解</a></li><li><a href="/isaacgaoblog/posts/重绘与重排.html" class="sidebar-link">重绘与重排</a></li><li><a href="/isaacgaoblog/posts/小白也可以搞懂的闭包.html" class="sidebar-link">小白也可以搞懂的闭包</a></li><li><a href="/isaacgaoblog/posts/小白上手Promise.html" class="sidebar-link">小白上手Promise</a></li><li><a href="/isaacgaoblog/posts/多人博客项目review.html" class="sidebar-link">多人博客项目Review</a></li><li><a href="/isaacgaoblog/posts/前端必须知道的HTTP缓存.html" class="sidebar-link">前端必须知道的HTTP缓存</a></li><li><a href="/isaacgaoblog/posts/从封装两个函数到入门jQuery.html" class="sidebar-link">从封装两个函数到入门jQuery</a></li><li><a href="/isaacgaoblog/posts/webpack4初次上手.html" class="sidebar-link">初次上手webpack4</a></li><li><a href="/isaacgaoblog/posts/Vue.2.x全家桶学习手记.html" class="sidebar-link">使用语雀整理Vue笔记</a></li><li><a href="/isaacgaoblog/posts/HTTPS通信机制.html" class="sidebar-link">HTTPS通信机制</a></li><li><a href="/isaacgaoblog/posts/Event_Loop和任务队列.html" class="sidebar-link">前端必须知道的Event Loop</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="从输入url到页面加载完毕中间发生了什么？"><a href="#从输入url到页面加载完毕中间发生了什么？" aria-hidden="true" class="header-anchor">#</a> 从输入url到页面加载完毕中间发生了什么？</h1> <p><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1512719712809&di=e3612f9c2013a7a2f2ba2085ece52883&imgtype=0&src=http%3A%2F%2Fnews.5068.com%2Fupfiles%2Fallimg%2F150414%2F8570_150414165859_4.jpg" alt="矢量图"></p> <blockquote><p>我们平时从浏览器中输入网址，到页面完整的呈现在面前，这中间究竟发生了什么呢？</p></blockquote> <h2 id="step1-在浏览器地址栏敲入url"><a href="#step1-在浏览器地址栏敲入url" aria-hidden="true" class="header-anchor">#</a> STEP1: 在浏览器地址栏敲入url</h2> <h3 id="首先，什么是url？"><a href="#首先，什么是url？" aria-hidden="true" class="header-anchor">#</a> 首先，什么是<strong>url</strong>？</h3> <p>url or <em>Uniform resource locator</em>，统一资源定位符，用于定位互联网上的资源，其实就是日常生活中我们所说的<strong>网址</strong>。url的格式为</p> <blockquote><p>协议类型://主机名:端口/路径/资源文件名</p></blockquote> <p>相应的例子如下：</p> <blockquote><p>http://www.jianshu.com/u/553d6196311c</p></blockquote> <p>以上范例是我简书的个人主页url:</p> <ul><li><p><code>http</code>表示与web服务器的通讯方式采用的协议类型为<strong>超文本协议</strong>，其它协议类型还有<code>https</code>（非明文的加密传输类型）、<code>file</code>、<code>ftp</code>、<code>mailto</code>等等；</p></li> <li><p><code>jianshu.com</code>就是主机的域名;</p></li> <li><p>主机域名后还会跟着冒号加数字的形式，为端口号，一台服务器可能拥有有大量的端口号，因此，指定一个端口编号以便告诉web服务器所在的主机要将请求交给哪个服务；默认情况下，http的端口号为<code>80</code>，因此可以省略端口号。</p></li> <li><p><code>u/553d6196311c</code>表示所请求的文件存在主机上的路径。</p></li></ul> <h3 id="ip是什么？"><a href="#ip是什么？" aria-hidden="true" class="header-anchor">#</a> IP是什么？</h3> <blockquote><p>IP(Internet Protocol)，计算机为了实现相互通信而遵守的协议，每个处于互联网中的设备都有IP。</p></blockquote> <p>如，192.168.0.1表示本地局域网，而127.0.0.1代表本机IP。局域网IP与公网IP是有区别的，局域网中所有人都是用路由器，使用局域网IP。</p> <h3 id="为什么要用域名？"><a href="#为什么要用域名？" aria-hidden="true" class="header-anchor">#</a> 为什么要用域名？</h3> <p>不用IP而使用域名来访问网站的原因是，域名是<strong>语义化</strong>的，可以被赋予人类语言或者代称，方便人类记忆与辨识，而IP是给程序看的。</p> <p>浏览器实际上是不知道<code>jianshu.com</code>是什么意思，它需要通过解析域名来获取这个站点所在服务器的IP，才能找到目标。所以我们来聊聊STEP2:<strong>域名解析</strong></p> <h2 id="step2-域名解析"><a href="#step2-域名解析" aria-hidden="true" class="header-anchor">#</a> STEP2: 域名解析</h2> <blockquote><p>如何把一个域名解析为IP地址？
当用户输入在浏览器地址栏中输入url后，你的电脑会发出一个DNS请求到本地DNS服务器。</p></blockquote> <ul><li><strong>DNS(Domain Name System)</strong>：域名与IP地址ip地址相互映射的一个分布式数据库；</li> <li><strong>本地DNS服务器</strong>：一般是网络接入的服务商提供的，比如中国电信、铁通等；</li> <li><strong>域名解析</strong>：使用户得以通过主机名，获得该主机名对应的IP地址的过程；</li></ul> <blockquote><p>DNS请求到达本地后，开始域名解析：</p></blockquote> <ul><li>浏览器缓存</li></ul> <blockquote><p>首先，浏览器会先开始从浏览器缓存中查找此前是否有这个域名对应的IP，如果缓存中有，域名解析结束；</p></blockquote> <blockquote><p>chrome浏览器可以通过<code>chrome://net-internals/#dns</code>来查看浏览器的DNS缓存时间：</p></blockquote> <blockquote><p><img src="https://i.loli.net/2017/12/09/5a2abe0f86a24.png" alt="屏幕快照 2017-12-09 上午12.27.37.png"></p></blockquote> <ul><li>系统缓存</li></ul> <blockquote><p>如果浏览器中没有缓存，浏览器会从系统中的<code>host</code>文件中查找是否有该域名对应的IP；</p></blockquote> <blockquote><p><img src="https://i.loli.net/2017/12/09/5a2abf141ae6e.png" alt="屏幕快照 2017-12-09 上午12.34.04.png"></p></blockquote> <blockquote><p>macos中host路劲：finder下shift+command+g，输入路径：/etc/hosts</p></blockquote> <ul><li>路由器缓存</li></ul> <blockquote><p>如果<code>host</code>文件中也没有缓存，便会查看连接过的路由器是否有缓存信息；</p></blockquote> <ul><li>ISP(internet service provider) DNS缓存</li></ul> <blockquote><p>如果路由器缓存也找不到，那就查找ISP DNS缓存，比如到电信的DNS上查找缓存。我们经常在网络设置中输入的<code>114.114.114.114</code>就是本地区的域名服务器，在全国各地都有部署节点，访问相对较快。</p></blockquote> <ul><li>迭代查询</li></ul> <blockquote><p>如果以上办法都找不到，则会向根域名服务器查找域名对应的IP，根域名服务器把请求转发到下一级，不断地返回IP，直到找到最终完整的IP地址；</p></blockquote> <ul><li><strong>根域名</strong>：可以理解为域名后缀，com、net、cn、org；</li> <li><strong>顶级域名</strong>：baidu.com</li></ul> <blockquote><p>整体流程如下：
<img src="http://upload-images.jianshu.io/upload_images/5308475-cf58e66c93c1f2ec.gif" alt="迭代查询"></p></blockquote> <p>当通过域名解析查找到IP地址之后，浏览器将用户发起的http请求发给服务器，例如：<code>GET http://www.baidu.com/ HTTP/1.1</code></p> <h2 id="step3-服务器处理请求"><a href="#step3-服务器处理请求" aria-hidden="true" class="header-anchor">#</a> STEP3: 服务器处理请求</h2> <blockquote><p>服务器是一台安装了linux系统的机器，系统里安装了处理请求的应用/软件叫<code>web server</code>，常见的如：<code>apache</code> 、<code>nginx</code> 、<code>IIS</code>等；</p></blockquote> <ul><li><strong>web服务器</strong>：</li></ul> <p>当<code>web server</code>接收到一个HTTP请求（request），会返回一个HTTP响应（response），例如送回一个HTML页面。所以web服务器就像一个管控或者承载，来调配用户的不同请求，将这些请求委托给服务器上处理对应请求的程序进行处理，如，服务端JS、JSP脚本，ASP脚本等等。</p> <p>这些服务端的程序如何处理请求，实际上就是后台处理的工作了。后台开发现在有很多框架，但大部分都还是按照MVC设计模式进行搭建的。</p> <blockquote><p><img src="http://upload-images.jianshu.io/upload_images/5308475-d45e8967170041f2.png" alt="MVC设计模式"></p></blockquote> <h3 id="mvc设计模式"><a href="#mvc设计模式" aria-hidden="true" class="header-anchor">#</a> MVC设计模式</h3> <p>用户输入请求，首先被控制器（起统一管理作用）接收，控制器来决定用哪个模型（操作数据库，给控制器提供接口）来处理来进行处理，然后模型根据业务逻辑处理用户请求，并且从数据库中返回存取数据，返回给控制器后，控制器确定用哪一个视图模型（把数据填写到视图模板），组合后返回给浏览器，并最终呈现为页面。</p> <h2 id="step4-浏览器处理"><a href="#step4-浏览器处理" aria-hidden="true" class="header-anchor">#</a> STEP4: 浏览器处理</h2> <blockquote><p>接下来就是浏览器处理，通过后台返回的HTML被一句句读取、解析，html页面在此过程中，经历了加载，解析，渲染。</p></blockquote> <ul><li><strong>加载</strong></li></ul> <ol><li>浏览器对一份HTML文件的加载顺序是自上而下，逐行加载的</li></ol> <ul><li><strong>解析</strong></li></ul> <ol><li>解析到<code>&lt;link&gt;</code>，重新发送请求，获取css代码；</li> <li>解析到<code>&lt;script&gt;</code>，发送请求，加载js，并且停止渲染，加载及解析完毕后，继续渲染其它；</li> <li>解析到<code>&lt;img&gt;</code>，发送请求获取图片资源；</li></ol> <ul><li><strong>渲染</strong></li></ul> <ol><li>浏览器根据HTML和CSS计算得到渲染树，绘制到用户屏幕上。</li></ol></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/isaacgaoblog/assets/js/app.01da7489.js" defer></script><script src="/isaacgaoblog/assets/js/21.341d678b.js" defer></script>
  </body>
</html>
