<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTPS通信机制 | 猪脚面线的知识库</title>
    <meta name="description" content="For what it&#39;s worth, it&#39;s never too late.（Updating... XD）">
    <link rel="icon" href="/isaacgaoblog/logo.ico">
    
    <link rel="preload" href="/isaacgaoblog/assets/css/0.styles.60655061.css" as="style"><link rel="preload" href="/isaacgaoblog/assets/js/app.01da7489.js" as="script"><link rel="preload" href="/isaacgaoblog/assets/js/16.fb97507d.js" as="script"><link rel="prefetch" href="/isaacgaoblog/assets/js/10.bb6e04e4.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/11.391fd545.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/12.602facc5.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/13.2d9982a6.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/14.83aaa352.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/15.90b7ef7b.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/17.d2fb61a5.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/18.5f85ae3a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/19.b706601e.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/2.3704caf5.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/20.66d4ff5f.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/21.341d678b.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/22.3af63f24.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/23.4ecf9c22.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/24.15a6c94a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/25.bc5a5667.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/26.823bab78.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/27.0327437d.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/28.db82409c.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/29.e695a449.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/3.98b19d1d.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/4.4d6e9538.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/5.44d0334a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/6.b35e585c.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/7.723d1e3a.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/8.e2bfc8ff.js"><link rel="prefetch" href="/isaacgaoblog/assets/js/9.508f61f1.js">
    <link rel="stylesheet" href="/isaacgaoblog/assets/css/0.styles.60655061.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/isaacgaoblog/" class="home-link router-link-active"><!----> <span class="site-name">猪脚面线的知识库</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/isaacgaoblog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/frontend/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/backend/" class="nav-link">后端</a></li></ul></div></div><div class="nav-item"><a href="/isaacgaoblog/posts/" class="nav-link router-link-active">博文</a></div><div class="nav-item"><a href="https://www.github.com/Cobatkao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/isaacgaoblog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/frontend/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/isaacgaoblog/article/backend/" class="nav-link">后端</a></li></ul></div></div><div class="nav-item"><a href="/isaacgaoblog/posts/" class="nav-link router-link-active">博文</a></div><div class="nav-item"><a href="https://www.github.com/Cobatkao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>博文</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/isaacgaoblog/posts/" class="sidebar-link">碎碎念</a></li><li><a href="/isaacgaoblog/posts/布局全解.html" class="sidebar-link">布局全解</a></li><li><a href="/isaacgaoblog/posts/重绘与重排.html" class="sidebar-link">重绘与重排</a></li><li><a href="/isaacgaoblog/posts/小白也可以搞懂的闭包.html" class="sidebar-link">小白也可以搞懂的闭包</a></li><li><a href="/isaacgaoblog/posts/小白上手Promise.html" class="sidebar-link">小白上手Promise</a></li><li><a href="/isaacgaoblog/posts/多人博客项目review.html" class="sidebar-link">多人博客项目Review</a></li><li><a href="/isaacgaoblog/posts/前端必须知道的HTTP缓存.html" class="sidebar-link">前端必须知道的HTTP缓存</a></li><li><a href="/isaacgaoblog/posts/从封装两个函数到入门jQuery.html" class="sidebar-link">从封装两个函数到入门jQuery</a></li><li><a href="/isaacgaoblog/posts/webpack4初次上手.html" class="sidebar-link">初次上手webpack4</a></li><li><a href="/isaacgaoblog/posts/Vue.2.x全家桶学习手记.html" class="sidebar-link">使用语雀整理Vue笔记</a></li><li><a href="/isaacgaoblog/posts/HTTPS通信机制.html" class="active sidebar-link">HTTPS通信机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/isaacgaoblog/posts/HTTPS通信机制.html#加密算法" class="sidebar-link">加密算法</a></li><li class="sidebar-sub-header"><a href="/isaacgaoblog/posts/HTTPS通信机制.html#https原理" class="sidebar-link">https原理</a></li></ul></li><li><a href="/isaacgaoblog/posts/Event_Loop和任务队列.html" class="sidebar-link">前端必须知道的Event Loop</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="https"><a href="#https" aria-hidden="true" class="header-anchor">#</a> https</h1> <p>https就是在原http的基础上加上一层用于数据加密、解密、身份认证的安全层。</p> <p>https本质上对于传输的数据用的是对称加密，但对于对称加密的密钥则采用非对称加密，非对称加密通过SSL协议进行再次加密，保证了公钥的安全。</p> <h2 id="加密算法"><a href="#加密算法" aria-hidden="true" class="header-anchor">#</a> 加密算法</h2> <p>据记载，公元前400年，古希腊人就发明了置换密码；在第二次世界大战期间，德国军方启用了“恩尼格玛”密码机，所以密码学在社会发展中有着广泛的用途。</p> <h3 id="对称加密"><a href="#对称加密" aria-hidden="true" class="header-anchor">#</a> 对称加密</h3> <p>有流式、分组两种，加密和解密都是使用的同一个密钥。</p> <p>例如：DES、AES-GCM、ChaCha20-Poly1305等</p> <h3 id="非对称加密"><a href="#非对称加密" aria-hidden="true" class="header-anchor">#</a> 非对称加密</h3> <p>加密使用的密钥和解密使用的密钥是不相同的，分别称为：公钥、私钥，公钥和算法都是公开的，私钥是保密的。非对称加密算法性能较低，但是安全性超强，由于其加密特性，非对称加密算法能加密的数据长度也是有限的。</p> <p>例如：RSA、DSA、ECDSA、 DH、ECDHE</p> <h3 id="哈希算法"><a href="#哈希算法" aria-hidden="true" class="header-anchor">#</a> 哈希算法</h3> <p>将任意长度的信息转换为较短的固定长度的值，通常其长度要比信息小得多，且算法不可逆。</p> <p>例如：MD5、SHA-1、SHA-2、SHA-256 等</p> <h3 id="数字签名"><a href="#数字签名" aria-hidden="true" class="header-anchor">#</a> 数字签名</h3> <p>签名就是在信息的后面再加上一段内容（信息经过hash后的值），可以证明信息没有被修改过。hash值一般都会加密后（也就是签名）再和信息一起发送，以保证这个hash值不被修改。</p> <h2 id="https原理"><a href="#https原理" aria-hidden="true" class="header-anchor">#</a> https原理</h2> <p><img src="https://i.loli.net/2018/12/26/5c2390c7e3e47.png" alt="Screen Shot 2018-12-26 at 10.30.34 PM.png"></p> <p>下面我按步骤，尽可能详细的描述</p> <ol><li><p>client向server索要一个<strong>非对称加密的公钥</strong>，用处是加密对称加密的密钥（也就是真正要用来加密内容的密钥）</p></li> <li><p><strong>服务端靠CA来保证用于加密对称加密密钥的安全</strong></p> <p>server并不直接把公钥给client，而是给它<strong>CA证书</strong>，证书内含有client需要的<strong>公钥</strong>，但是它被CA的私钥加密过了，需要用<strong>CA的公钥</strong>解密（是的，数字证书中的非对称加密的公钥的加密方式也是非对称加密，只不过这里是使用只有权威机构自己才有的私钥加密的），才能获取用于对称加密的公钥（server提供）</p> <blockquote><p>SSL证书一般包含以下内容：
1. 证书的发布机构CA
2. 证书的有效期
3. 公钥
4. 证书所有者
5. <strong>签名</strong>：证书内容的签名，先通过Hash函数计算得到证书数字摘要，然后用权威机构私钥加密数字摘要得到数字签名。用于client收到证书后，使用权威机构的公钥解密数字证书，得到证书内容（服务器的公钥）以及证书的数字签名，然后根据证书上描述的计算证书签名的方法计算一下当前证书的签名，与收到的签名作对比，如果一样，表示证书一定是服务器下发的，没有被中间人篡改过。因为中间人虽然有权威机构的公钥，能够解析证书内容并篡改，但是篡改完成之后中间人需要将证书重新加密，但是中间人没有权威机构的私钥，无法加密，强行加密只会导致客户端无法解密，如果中间人强行乱修改证书，就会导致证书内容和证书签名不匹配。所以证书签名就能判断证书是否被篡改</p></blockquote></li> <li><p><strong>客户端拿到证书后不会傻傻的直接用，而是验证证书真假</strong></p> <p>client在接受到server发来的SSL证书时，会对证书的<strong>真伪进行校验</strong>，校验成功后才会用CA的公钥（CA公钥内置在浏览器或操作系统环境中）解密，正确解密server提供的公钥。它是这样验真伪的：</p> <blockquote><p>对照证书所有者/有效期 ---&gt; 对照CA机构 ---&gt; 取出CA公钥，对签名进行解密 ---&gt; 比对hash计算出hash值与证书签名 ---&gt; 受信任的证书，成功取出公钥</p></blockquote> <ol><li>首先浏览器读取证书中的证书所有者、有效期等信息进行一一校验</li> <li>浏览器开始<strong>查找</strong>操作系统中已内置的受信任的证书发布机构CA，与服务器发来的证书中的颁发者CA比对，用于校验证书是否为合法机构颁发</li> <li><strong>如果找不到</strong>，浏览器就会报错，说明服务器发来的证书是不可信任的</li> <li><strong>如果找到</strong>，那么浏览器就会从操作系统中取出颁发者CA的公钥，然后对服务器发来的证书里面的签名<strong>进行解密</strong></li> <li><strong>浏览器使用相同的hash算法计算出服务器发来的证书的hash值，将这个计算的hash值与证书中签名做对比</strong></li> <li>对比结果一致，则证明服务器发来的证书合法，没有被冒充</li> <li>此时浏览器就可以读取证书中的公钥，用于后续加密对称加密密钥了</li></ol> <blockquote><p><strong>所以通过发送SSL证书的形式，既解决了公钥获取问题，又解决了黑客冒充问题，一箭双雕，HTTPS加密过程也就此形成</strong></p></blockquote></li> <li><p>client生成一个随机数，也就是对成加密的密钥，然后用上一步获取到的server公钥加密随机数，发送回server</p></li> <li><p>server用自己此前生成的非对称加密的私钥解密得到的随机数，获取真正的对称加密密钥，以后client和server通信都可以愉快的用这个密钥了！</p></li></ol> <p><strong>细节</strong></p> <p>这里面涉及到三组密钥：</p> <ol><li>对称加密的密钥：最后用于真正加密的密钥</li> <li>CA证书内的非对称加密密钥：用来加密client生成的随机数，私钥服务器自己保存着，等client加密完发回来解密用</li> <li>CA的密钥：私钥CA自己保存，公钥内置在各个操作系统中，主要用来加密server要传给client的公钥</li></ol> <h1 id="对比http"><a href="#对比http" aria-hidden="true" class="header-anchor">#</a> 对比http</h1> <p>所以相比HTTP，HTTPS 传输更加安全</p> <ol><li>所有信息都是加密传播，黑客无法<strong>窃听</strong>；</li> <li>具有校验机制，一旦被<strong>篡改</strong>，通信双方会立刻发现；</li> <li>配备身份证书，防止身份被<strong>冒充</strong>；</li></ol> <h1 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h1> <p>综上所述，相比 HTTP 协议，HTTPS 协议增加了很多握手、加密解密等流程，虽然过程很复杂，但其可以保证数据传输的安全。所以在这个互联网膨胀的时代，其中隐藏着各种看不见的危机，为了保证数据的安全，维护网络稳定，建议大家多多推广HTTPS。</p> <h1 id="参考与拓展"><a href="#参考与拓展" aria-hidden="true" class="header-anchor">#</a> 参考与拓展</h1> <ol><li><a href="https://zhuanlan.zhihu.com/p/27395037" target="_blank" rel="noopener noreferrer">HTTPS系列干货（一）：HTTPS 原理详解
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/25976060" target="_blank" rel="noopener noreferrer">看完还不懂HTTPS我直播吃翔<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/isaacgaoblog/assets/js/app.01da7489.js" defer></script><script src="/isaacgaoblog/assets/js/16.fb97507d.js" defer></script>
  </body>
</html>
